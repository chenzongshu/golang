# 协程

多线程开发设计要考虑很多同步竞争等问题，如锁、竞争冲突等。

其实一个线程分为 “内核态 “线程和” 用户态 “线程。

**一个 “用户态线程” 必须要绑定一个 “内核态线程”**，但是 CPU 并不知道有 “用户态线程” 的存在，它只知道它运行的是一个 “内核态线程”(Linux 的 PCB 进程控制块)。

然后就设计了这么一套东西：内核线程依然叫 “线程 (thread)”，用户线程叫 “协程 (co-routine)”

协程和内核态线程可以1：1，也可以N：1，也可以M：N，其中

协程跟线程是有区别的，线程由 CPU 调度是抢占式的，**协程由用户态调度是协作式的**，一个协程让出 CPU 后，才执行下一个协程

# GMP

## 概念

- G：goroutine协程
- M：thread线程
- P：processor处理器，包含了运行 goroutine 的资源，如果线程想运行 goroutine，必须先获取 P，P 中还包含了可运行的 G 队列

## 模型

在 Go 中，**线程是运行 goroutine 的实体，调度器的功能是把可运行的 goroutine 分配到工作线程上**。



